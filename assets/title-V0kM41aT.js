import{c as u,a as _,d as g,b as f,s as w,e as v}from"./firebase-vendor-DDc4M5Fe.js";import{C as y,a as k,D as T,E as D}from"./index-yKJbQATM.js";import{g as p}from"./PostCreateScreen-BdtUvpFY.js";import"./ui-vendor-JVI_EMCz.js";import"./react-vendor-Bzgz95E1.js";import"./imageUpload-CIfQ42AF.js";const h=[{id:"first_post",name:"ÂàùÊäïÁ®øËÄÖ",description:"Âàù„ÇÅ„Å¶„ÅÆÊäïÁ®ø„Çí„Åó„Åæ„Åó„Åü",category:"beginner",icon:"üéâ",rarity:"common",condition:{type:"first_post"},order:1},{id:"profile_complete",name:"„Éó„É≠„Éï„Ç£„Éº„É´ÂÆåÊàê",description:"„Éó„É≠„Éï„Ç£„Éº„É´„ÇíÂÆåÊàê„Åï„Åõ„Åæ„Åó„Åü",category:"beginner",icon:"üë§",rarity:"common",condition:{type:"profile_complete"},order:2},{id:"first_like",name:"„ÅÑ„ÅÑ„Å≠ÂàùÂøÉËÄÖ",description:"Âàù„ÇÅ„Å¶„ÅÑ„ÅÑ„Å≠„Çí„Åó„Åæ„Åó„Åü",category:"beginner",icon:"üëç",rarity:"common",condition:{type:"like_count",threshold:1},order:3},{id:"first_comment",name:"„Ç≥„É°„É≥„ÉàÂàùÂøÉËÄÖ",description:"Âàù„ÇÅ„Å¶„Ç≥„É°„É≥„Éà„Çí„Åó„Åæ„Åó„Åü",category:"beginner",icon:"üí¨",rarity:"common",condition:{type:"comment_count",threshold:1},order:4},{id:"post_10",name:"ÊäïÁ®øËÄÖ",description:"10ÂõûÊäïÁ®ø„Åó„Åæ„Åó„Åü",category:"poster",icon:"üìù",rarity:"common",condition:{type:"post_count",threshold:10},order:10},{id:"post_50",name:"Á©çÊ•µÊäïÁ®øËÄÖ",description:"50ÂõûÊäïÁ®ø„Åó„Åæ„Åó„Åü",category:"poster",icon:"üìö",rarity:"rare",condition:{type:"post_count",threshold:50},order:11},{id:"post_100",name:"ÊäïÁ®ø„Éû„Çπ„Çø„Éº",description:"100ÂõûÊäïÁ®ø„Åó„Åæ„Åó„Åü",category:"poster",icon:"üìñ",rarity:"epic",condition:{type:"post_count",threshold:100},order:12},{id:"post_500",name:"ÊäïÁ®ø„ÅÆ‰ºùË™¨",description:"500ÂõûÊäïÁ®ø„Åó„Åæ„Åó„Åü",category:"poster",icon:"üìú",rarity:"legendary",condition:{type:"post_count",threshold:500},order:13},{id:"follower_10",name:"‰∫∫Ê∞óËÄÖ",description:"„Éï„Ç©„É≠„ÉØ„Éº„Åå10‰∫∫„Å´„Å™„Çä„Åæ„Åó„Åü",category:"social",icon:"‚≠ê",rarity:"common",condition:{type:"follower_count",threshold:10},order:20},{id:"follower_50",name:"‰∫∫Ê∞óËÄÖÔºã",description:"„Éï„Ç©„É≠„ÉØ„Éº„Åå50‰∫∫„Å´„Å™„Çä„Åæ„Åó„Åü",category:"social",icon:"üåü",rarity:"rare",condition:{type:"follower_count",threshold:50},order:21},{id:"follower_100",name:"„Ç§„É≥„Éï„É´„Ç®„É≥„Çµ„Éº",description:"„Éï„Ç©„É≠„ÉØ„Éº„Åå100‰∫∫„Å´„Å™„Çä„Åæ„Åó„Åü",category:"social",icon:"‚ú®",rarity:"epic",condition:{type:"follower_count",threshold:100},order:22},{id:"follower_500",name:"„Ç´„É™„Çπ„Éû",description:"„Éï„Ç©„É≠„ÉØ„Éº„Åå500‰∫∫„Å´„Å™„Çä„Åæ„Åó„Åü",category:"social",icon:"üëë",rarity:"legendary",condition:{type:"follower_count",threshold:500},order:23},{id:"following_50",name:"Á§æ‰∫§ÂÆ∂",description:"50‰∫∫„Çí„Éï„Ç©„É≠„Éº„Åó„Åæ„Åó„Åü",category:"social",icon:"ü§ù",rarity:"common",condition:{type:"following_count",threshold:50},order:24},{id:"like_100",name:"„ÅÑ„ÅÑ„Å≠ÈõÜ„ÇÅ",description:"ÊäïÁ®ø„Åå100„ÅÑ„ÅÑ„Å≠„ÇíÁç≤Âæó„Åó„Åæ„Åó„Åü",category:"achievement",icon:"üíï",rarity:"common",condition:{type:"total_likes",threshold:100},order:30},{id:"like_500",name:"„ÅÑ„ÅÑ„Å≠„Éû„Çπ„Çø„Éº",description:"ÊäïÁ®ø„Åå500„ÅÑ„ÅÑ„Å≠„ÇíÁç≤Âæó„Åó„Åæ„Åó„Åü",category:"achievement",icon:"üíñ",rarity:"rare",condition:{type:"total_likes",threshold:500},order:31},{id:"like_1000",name:"„ÅÑ„ÅÑ„Å≠„ÅÆÁéã",description:"ÊäïÁ®ø„Åå1,000„ÅÑ„ÅÑ„Å≠„ÇíÁç≤Âæó„Åó„Åæ„Åó„Åü",category:"achievement",icon:"üëë",rarity:"epic",condition:{type:"total_likes",threshold:1e3},order:32},{id:"popular_post",name:"„Éà„É¨„É≥„ÉâÂÖ•„Çä",description:"ÊäïÁ®ø„Åå„Éà„É¨„É≥„Éâ„Å´Ëºâ„Çä„Åæ„Åó„Åü",category:"achievement",icon:"üî•",rarity:"epic",condition:{type:"popular"},order:33},{id:"recipe_1",name:"„É¨„Ç∑„ÉîÂàùÂøÉËÄÖ",description:"Âàù„ÇÅ„Å¶„É¨„Ç∑„Éî„ÇíÊäïÁ®ø„Åó„Åæ„Åó„Åü",category:"recipe",icon:"üç≥",rarity:"common",condition:{type:"recipe_count",threshold:1},order:40},{id:"recipe_10",name:"„É¨„Ç∑„Éî„Ç≥„É¨„ÇØ„Çø„Éº",description:"10ÂÄã„ÅÆ„É¨„Ç∑„Éî„ÇíÊäïÁ®ø„Åó„Åæ„Åó„Åü",category:"recipe",icon:"üë®‚Äçüç≥",rarity:"rare",condition:{type:"recipe_count",threshold:10},order:41},{id:"recipe_50",name:"„Ç∑„Çß„Éï",description:"50ÂÄã„ÅÆ„É¨„Ç∑„Éî„ÇíÊäïÁ®ø„Åó„Åæ„Åó„Åü",category:"recipe",icon:"üçΩÔ∏è",rarity:"epic",condition:{type:"recipe_count",threshold:50},order:42},{id:"streak_7",name:"Á∂ôÁ∂ö„ÅÆÂäõ",description:"7Êó•ÈÄ£Á∂ö„ÅßÊäïÁ®ø„Åó„Åæ„Åó„Åü",category:"achievement",icon:"üî•",rarity:"rare",condition:{type:"consecutive_days",threshold:7},order:50},{id:"streak_30",name:"Á∂ôÁ∂ö„ÅÆÈÅî‰∫∫",description:"30Êó•ÈÄ£Á∂ö„ÅßÊäïÁ®ø„Åó„Åæ„Åó„Åü",category:"achievement",icon:"üí™",rarity:"epic",condition:{type:"consecutive_days",threshold:30},order:51},{id:"streak_100",name:"Á∂ôÁ∂ö„ÅÆ‰ºùË™¨",description:"100Êó•ÈÄ£Á∂ö„ÅßÊäïÁ®ø„Åó„Åæ„Åó„Åü",category:"achievement",icon:"üèÜ",rarity:"legendary",condition:{type:"consecutive_days",threshold:100},order:52},{id:"veteran_30",name:"„Éô„ÉÜ„É©„É≥",description:"ÁôªÈå≤„Åã„Çâ30Êó•„ÅåÁµåÈÅé„Åó„Åæ„Åó„Åü",category:"special",icon:"üéñÔ∏è",rarity:"rare",condition:{type:"veteran",threshold:30},order:60},{id:"veteran_100",name:"Âè§ÂèÇ",description:"ÁôªÈå≤„Åã„Çâ100Êó•„ÅåÁµåÈÅé„Åó„Åæ„Åó„Åü",category:"special",icon:"üèÖ",rarity:"epic",condition:{type:"veteran",threshold:100},order:61},{id:"veteran_365",name:"„É¨„Ç∏„Çß„É≥„Éâ",description:"ÁôªÈå≤„Åã„Çâ1Âπ¥„ÅåÁµåÈÅé„Åó„Åæ„Åó„Åü",category:"special",icon:"üëë",rarity:"legendary",condition:{type:"veteran",threshold:365},order:62},{id:"trend_setter",name:"„Éà„É¨„É≥„Éâ„Çª„ÉÉ„Çø„Éº",description:"„Éà„É¨„É≥„Éâ„Éè„ÉÉ„Ç∑„É•„Çø„Ç∞„Çí‰ΩúÊàê„Åó„Åæ„Åó„Åü",category:"special",icon:"üìà",rarity:"epic",condition:{type:"hashtag_trend"},order:70},{id:"comment_master",name:"„Ç≥„É°„É≥„Éà„Éû„Çπ„Çø„Éº",description:"100Âõû„Ç≥„É°„É≥„Éà„Åó„Åæ„Åó„Åü",category:"achievement",icon:"üí≠",rarity:"rare",condition:{type:"comment_count",threshold:100},order:71},{id:"repost_master",name:"„É™„Éù„Çπ„Éà„Éû„Çπ„Çø„Éº",description:"50Âõû„É™„Éù„Çπ„Éà„Åó„Åæ„Åó„Åü",category:"achievement",icon:"üîÑ",rarity:"rare",condition:{type:"repost_count",threshold:50},order:72},{id:"all_rounder",name:"„Ç™„Éº„É´„É©„Ç¶„É≥„ÉÄ„Éº",description:"„Åô„Åπ„Å¶„ÅÆ„Ç´„ÉÜ„Ç¥„É™„ÅßÁß∞Âè∑„ÇíÁç≤Âæó„Åó„Åæ„Åó„Åü",category:"special",icon:"‚≠ê",rarity:"legendary",condition:{type:"special"},order:73}],m=async r=>{try{const e=u(y,`users/${r}/titles`),t=await _(e),i=[];return t.forEach(o=>{const n=o.data();i.push({userId:r,titleId:o.id,earnedAt:n.earnedAt||new Date().toISOString(),isEquipped:n.isEquipped||!1})}),i}catch(e){return console.error("Áß∞Âè∑ÂèñÂæó„Ç®„É©„Éº:",e),[]}},H=async r=>{try{const t=(await m(r)).find(o=>o.isEquipped);return t&&q(t.titleId)||null}catch(e){return console.error("Ë£ÖÂÇôÁß∞Âè∑ÂèñÂæó„Ç®„É©„Éº:",e),null}},b=async(r,e)=>{try{const t=g(y,`users/${r}/titles`,e);if((await f(t)).exists())return;await w(t,{earnedAt:v(),isEquipped:!1}),console.log(`‚úÖ Áß∞Âè∑„Çí‰ªò‰∏é„Åó„Åæ„Åó„Åü: ${e} („É¶„Éº„Ç∂„Éº: ${r})`)}catch(t){throw console.error("Áß∞Âè∑‰ªò‰∏é„Ç®„É©„Éº:",t),t}},q=r=>h.find(e=>e.id===r),A=async(r,e)=>{try{const t=await k(r);if(!t)return!1;switch(e.type){case"first_post":return t.stats.postCount>=1;case"post_count":return e.threshold!==void 0&&t.stats.postCount>=e.threshold;case"like_count":return!1;case"follower_count":{const i=await D(r);return e.threshold!==void 0&&i>=e.threshold}case"following_count":{const i=await T(r);return e.threshold!==void 0&&i>=e.threshold}case"recipe_count":return e.threshold!==void 0&&t.stats.recipeCount>=e.threshold;case"consecutive_days":{const o=(await p(r,100)).map(c=>c.createdAt.split("T")[0]),n=[...new Set(o)].sort().reverse();if(n.length===0)return!1;let s=0;const d=new Date;d.setHours(0,0,0,0);for(let c=0;c<n.length;c++){const l=new Date(n[c]);l.setHours(0,0,0,0);const a=new Date(d);if(a.setDate(a.getDate()-c),a.setHours(0,0,0,0),l.getTime()===a.getTime())s++;else break}return e.threshold!==void 0&&s>=e.threshold}case"total_likes":{const o=(await p(r,1e3)).reduce((n,s)=>n+(s.likes||0),0);return e.threshold!==void 0&&o>=e.threshold}case"comment_count":return!1;case"repost_count":return!1;case"hashtag_trend":return!1;case"profile_complete":return!!(t.bio&&t.avatarUrl);case"veteran":{const i=new Date(t.createdAt),n=Math.floor((new Date().getTime()-i.getTime())/(1e3*60*60*24));return e.threshold!==void 0&&n>=e.threshold}case"popular":return!1;case"special":return!1;default:return!1}}catch(t){return console.error("Áß∞Âè∑Êù°‰ª∂„ÉÅ„Çß„ÉÉ„ÇØ„Ç®„É©„Éº:",t),!1}},M=async r=>{try{const e=await m(r),t=new Set(e.map(o=>o.titleId)),i=[];for(const o of h){if(t.has(o.id))continue;await A(r,o.condition)&&(await b(r,o.id),i.push(o.id))}return i}catch(e){return console.error("Áß∞Âè∑„ÉÅ„Çß„ÉÉ„ÇØ„Ç®„É©„Éº:",e),[]}};export{M as checkAndGrantTitles,A as checkTitleCondition,H as getEquippedTitle,q as getTitleById,m as getUserTitles,b as grantTitle};
