# 技術スタック - 健康家計アプリ (React版)

**最終更新: 2025-10-27**

このドキュメントは、健康家計アプリで使用されているすべての技術、ライブラリ、API、ツールを網羅的にまとめたものです。

---

## 📋 目次

1. [フロントエンド](#フロントエンド)
2. [状態管理](#状態管理)
3. [UIライブラリ・コンポーネント](#uiライブラリコンポーネント)
4. [バックエンド・クラウドサービス](#バックエンドクラウドサービス)
5. [外部API](#外部api)
6. [PWA関連技術](#pwa関連技術)
7. [ユーティリティライブラリ](#ユーティリティライブラリ)
8. [ビルドツール・開発環境](#ビルドツール開発環境)
9. [デプロイ・ホスティング](#デプロイホスティング)
10. [開発ツール](#開発ツール)
11. [バージョン一覧](#バージョン一覧)

---

## 🎨 フロントエンド

### React
- **バージョン**: 19.1.1
- **用途**: UIライブラリ
- **特徴**: 最新のReact 19を使用、コンポーネントベースの設計
- **公式サイト**: https://react.dev/

### React DOM
- **バージョン**: 19.1.1
- **用途**: ReactのDOM操作ライブラリ
- **特徴**: React 19に対応した最新版

### TypeScript
- **バージョン**: 5.9.3
- **用途**: 型安全なJavaScript
- **特徴**: 厳格な型チェック、verbatimModuleSyntax有効
- **設定ファイル**: `tsconfig.json`, `tsconfig.app.json`, `tsconfig.node.json`
- **公式サイト**: https://www.typescriptlang.org/

---

## 🗃️ 状態管理

### Zustand
- **バージョン**: 5.0.8
- **用途**: 軽量な状態管理ライブラリ
- **特徴**:
  - Redux不要のシンプルなAPI
  - localStorage永続化
  - Firestore同期機能
  - リアルタイム更新（onSnapshot）
- **実装ストア**:
  - `useIntakeStore` - 食事記録
  - `useExpenseStore` - 支出管理
  - `useStockStore` - 在庫管理
  - `useShoppingStore` - 買い物リスト
  - `useRecipeStore` - レシピ履歴・お気に入り
  - `useSettingsStore` - 設定・ダークモード
  - `useBadgeStore` - バッジ・アチーブメント
- **公式サイト**: https://zustand.docs.pmnd.rs/

---

## 🎨 UIライブラリ・コンポーネント

### React Icons
- **バージョン**: 5.5.0
- **用途**: アイコンライブラリ
- **使用アイコンセット**:
  - Material Design Icons (`react-icons/md`)
  - Feather Icons (`react-icons/fi`)
  - Bootstrap Icons (`react-icons/bs`)
- **特徴**: 統一されたアイコンシステム、ツリーシェイキング対応
- **公式サイト**: https://react-icons.github.io/react-icons/

### Material UI (MUI)
- **バージョン**: 7.3.4
- **パッケージ**:
  - `@mui/material` - コンポーネントライブラリ
  - `@mui/icons-material` - アイコンセット
- **用途**: マテリアルデザインコンポーネント
- **使用コンポーネント**: 一部で使用（主にReact Iconsを優先）
- **公式サイト**: https://mui.com/

### Emotion
- **バージョン**: 11.14.0 / 11.14.1
- **パッケージ**:
  - `@emotion/react`
  - `@emotion/styled`
- **用途**: CSS-in-JSライブラリ（MUIの依存関係）
- **公式サイト**: https://emotion.sh/

### Recharts
- **バージョン**: 3.2.1
- **用途**: データ可視化ライブラリ
- **使用グラフ**:
  - 折れ線グラフ（食事記録の推移）
  - 円グラフ（支出のカテゴリ別集計）
  - 棒グラフ（月次レポート）
- **特徴**: React専用、レスポンシブ対応
- **公式サイト**: https://recharts.org/

---

## ☁️ バックエンド・クラウドサービス

### Firebase
- **バージョン**: 12.4.0
- **プロジェクトID**: `oshi-para`
- **プラン**: Blaze（従量課金制）
- **リージョン**: asia-northeast1（東京）

#### Firebase Authentication
- **用途**: ユーザー認証
- **サポート認証方式**:
  - メール/パスワード
  - Google OAuth
- **機能**:
  - ログイン/ログアウト
  - 新規登録（3ステップフロー）
  - 認証状態の監視
- **実装ファイル**:
  - `src/config/firebase.ts`
  - `src/utils/auth.ts`
  - `src/components/auth/LoginScreen.tsx`
  - `src/components/auth/RegisterFlow.tsx`

#### Firestore Database
- **用途**: NoSQLクラウドデータベース
- **データ構造**:
  ```
  users/{userId}/
    ├── intakes (食事記録)
    ├── expenses (支出)
    ├── stocks (在庫)
    ├── shopping (買い物リスト)
    ├── recipes (レシピ履歴・お気に入り)
    └── settings (設定)

  verificationCodes/{email}
    └── 確認コード（10分間有効）
  ```
- **セキュリティルール**: `firestore.rules`
- **特徴**:
  - ユーザーごとのデータ分離
  - リアルタイム同期（onSnapshot）
  - オフライン対応
- **実装ファイル**: `src/utils/firestore.ts`

#### Cloud Functions
- **ランタイム**: Node.js 18
- **用途**: サーバーサイドロジック
- **実装Function**:
  - `sendVerificationEmail` - 確認コードメール送信
- **デプロイ**: `firebase deploy --only functions`
- **ディレクトリ**: `functions/`

**Cloud Functions 依存関係:**
- `firebase-admin` 12.0.0 - Firebase Admin SDK
- `firebase-functions` 5.0.0 - Cloud Functions SDK
- `nodemailer` 6.9.8 - メール送信
- `@types/nodemailer` 6.4.14 - Nodemailer型定義

### Nodemailer
- **バージョン**: 6.9.8
- **用途**: メール送信（Cloud Functions内で使用）
- **SMTP設定**:
  - プロバイダー: Gmail
  - 認証: Googleアプリパスワード
  - 環境変数: `gmail.email`, `gmail.password`
- **メール形式**: HTML（グラデーション、プロフェッショナル）
- **送信内容**: 6桁の確認コード
- **公式サイト**: https://nodemailer.com/

---

## 🌐 外部API

### Google Gemini API
- **用途**: AI機能（レシピ生成、健康アドバイス、レシートOCR）
- **使用モデル**:
  - `gemini-2.0-flash-exp` - レシピ生成、健康アドバイザー
  - `gemini-2.5-flash-lite` - レシートOCR（1日1,000リクエスト）
- **Free Tierの制限**:
  - 15リクエスト/分
  - 1,500リクエスト/日
  - 1,000,000トークン/日
- **実装機能**:
  - AIレシピ生成（在庫・買い物リストから）
  - レシート画像のOCR（商品名・価格・数量を抽出）
  - 月次レポートのAI改善提案
- **実装ファイル**: `src/api/gemini.ts`
- **環境変数**: `VITE_GEMINI_API_KEY`
- **公式サイト**: https://ai.google.dev/

### 楽天市場商品検索API
- **用途**: バーコードスキャン（商品情報取得）
- **検索方法**: JANコードで検索
- **レスポンス**: 商品名、価格、画像URL
- **実装ファイル**: `src/api/rakuten.ts`
- **環境変数**: `VITE_RAKUTEN_APP_ID`
- **公式サイト**: https://webservice.rakuten.co.jp/

### 楽天商品検索API
- **用途**: バーコードスキャン（代替API）
- **検索方法**: JANコードで検索
- **実装ファイル**: `src/api/rakuten.ts`

### JAN Code Lookup API
- **用途**: バーコードスキャン（代替API）
- **検索方法**: JANコードで検索
- **実装ファイル**: `src/api/rakuten.ts`
- **環境変数**: `VITE_JANCODE_APP_ID`

### Open Food Facts API
- **用途**: バーコードスキャン（食品データベース）
- **検索方法**: JANコードで検索
- **特徴**: オープンソース、無料、APIキー不要
- **実装ファイル**: `src/api/rakuten.ts`
- **公式サイト**: https://world.openfoodfacts.org/

### EmailJS (未使用)
- **バージョン**: 4.4.1
- **用途**: フロントエンドからのメール送信（現在は未使用）
- **状況**: Cloud Functions + Nodemailerに置き換え済み
- **パッケージ**: `@emailjs/browser`

---

## 📱 PWA関連技術

### Service Worker
- **ファイル**: `public/sw.js`
- **バージョン**: v2
- **戦略**: Network-first（ネットワーク優先）
- **キャッシュ対象**:
  - HTML, CSS, JavaScript
  - アイコン画像
  - Webフォント
- **オフライン対応**: ネットワーク不通時にキャッシュから配信
- **更新戦略**: バージョン変更時に古いキャッシュを削除

### Web App Manifest
- **ファイル**: `public/manifest.webmanifest`
- **設定項目**:
  - `name`: "健康家計アプリ"
  - `short_name`: "健康家計"
  - `start_url`: "/"
  - `display`: "standalone"
  - `theme_color`, `background_color`
  - `icons`: 192x192, 512x512
- **機能**: ホーム画面に追加、スプラッシュ画面

### Web Notification API
- **用途**: 食事記録リマインダー
- **通知タイミング**:
  - 朝食: デフォルト 07:00
  - 昼食: デフォルト 12:00
  - 夕食: デフォルト 18:00
- **権限**: ユーザーが許可した場合のみ
- **実装ファイル**: `src/utils/notifications.ts`
- **設定UI**: `src/components/settings/NotificationSettings.tsx`

---

## 🔧 ユーティリティライブラリ

### @zxing/library
- **バージョン**: 0.21.3
- **用途**: バーコード・QRコードスキャン
- **サポート形式**: JAN/EAN-13, QRコード等
- **実装**: カメラ映像からリアルタイム読み取り
- **実装ファイル**: `src/components/barcode/BarcodeScanner.tsx`
- **公式サイト**: https://github.com/zxing-js/library

### Tesseract.js
- **バージョン**: 6.0.1
- **用途**: OCR（光学文字認識）
- **使用状況**: レシートOCR（現在はGemini APIを使用）
- **言語**: 日本語 (jpn), 英語 (eng)
- **公式サイト**: https://tesseract.projectnaptha.com/

### uuid
- **バージョン**: 13.0.0
- **用途**: 一意なID生成
- **使用箇所**: 食事記録、支出、在庫等のID生成
- **実装**: `uuid.v4()`
- **公式サイト**: https://github.com/uuidjs/uuid

---

## 🛠️ ビルドツール・開発環境

### Vite
- **バージョン**: 7.1.7
- **用途**: 高速ビルドツール
- **特徴**:
  - 超高速HMR（Hot Module Replacement）
  - ESMベースの開発サーバー
  - Rollupベースの本番ビルド
- **プラグイン**: `@vitejs/plugin-react` 5.0.4
- **設定ファイル**: `vite.config.ts`
- **設定項目**:
  - `base: '/life-pwa-react/'` - GitHub Pages用
  - `define` - 環境変数の置き換え
- **公式サイト**: https://vitejs.dev/

### TypeScript Compiler (tsc)
- **バージョン**: 5.9.3
- **用途**: TypeScriptのコンパイル
- **ビルドコマンド**: `tsc -b && vite build`
- **設定**:
  - `target: ES2020`
  - `module: ESNext`
  - `verbatimModuleSyntax: true`
  - `strict: true`

---

## 🚀 デプロイ・ホスティング

### GitHub Pages
- **URL**: https://haradakouta.github.io/life-pwa-react/
- **ブランチ**: `gh-pages`
- **ベースパス**: `/life-pwa-react/`
- **デプロイ方法**: `npm run deploy`
- **自動化**: git pushで自動デプロイ

### gh-pages
- **バージョン**: 6.3.0
- **用途**: GitHub Pagesへのデプロイツール
- **コマンド**: `gh-pages -d dist`
- **機能**: distフォルダをgh-pagesブランチにプッシュ
- **公式サイト**: https://github.com/tschaub/gh-pages

---

## 🧪 開発ツール

### ESLint
- **バージョン**: 9.36.0
- **用途**: コード品質チェック
- **プラグイン**:
  - `@eslint/js` 9.36.0
  - `eslint-plugin-react-hooks` 5.2.0
  - `eslint-plugin-react-refresh` 0.4.22
- **設定ファイル**: `eslint.config.js`

### TypeScript ESLint
- **バージョン**: 8.45.0
- **用途**: TypeScript用のESLintルール
- **パッケージ**: `typescript-eslint`

### 型定義
- **@types/react**: 19.1.16
- **@types/react-dom**: 19.1.9
- **@types/node**: 24.6.0
- **@types/uuid**: 10.0.0
- **@types/nodemailer**: 6.4.14

### その他開発ツール
- **globals**: 16.4.0 - グローバル変数定義

---

## 🎨 スタイリング

### CSS
- **ファイル**: `src/styles/global.css`
- **特徴**:
  - CSS Variables（カスタムプロパティ）
  - ダークモード対応
  - レスポンシブデザイン
- **CSS Variables**:
  - `--primary`, `--secondary`, `--accent`
  - `--background`, `--card`, `--text`
  - `--success`, `--warning`, `--danger`
- **アニメーション**:
  - `fadeIn`, `slideUp`, `slideIn`
  - `scaleIn`, `float`, `shimmer`
  - `pulse`, `bounce`

### レスポンシブデザイン
- **ブレークポイント**:
  - モバイル: `< 768px`
  - タブレット: `768px - 1024px`
  - デスクトップ: `> 1024px`

---

## 📦 データ永続化

### localStorage
- **用途**: ローカルデータ保存
- **実装**: `src/utils/localStorage.ts`
- **保存データ**:
  - 食事記録 (`app-intakes`)
  - 支出 (`app-expenses`)
  - 在庫 (`app-stocks`)
  - 買い物リスト (`app-shopping`)
  - レシピ (`app-recipes`)
  - 設定 (`app-settings`)
  - バッジ (`app-badges`)
- **特徴**:
  - オフライン動作
  - Firestoreと同期

### Firestore
- **用途**: クラウドデータ保存
- **特徴**:
  - リアルタイム同期
  - 複数デバイス間でデータ共有
  - オフライン対応（自動キャッシュ）

---

## 🌍 ブラウザ対応

### 対応ブラウザ
- Chrome/Edge: 最新版
- Firefox: 最新版
- Safari: 最新版
- モバイルブラウザ: iOS Safari, Chrome for Android

### 必要なブラウザAPI
- ES2020サポート
- Web Notification API
- Service Worker API
- localStorage API
- Camera API (getUserMedia)
- File API

---

## 📊 バージョン一覧

### フロントエンド（dependencies）
```json
{
  "@emailjs/browser": "^4.4.1",
  "@emotion/react": "^11.14.0",
  "@emotion/styled": "^11.14.1",
  "@mui/icons-material": "^7.3.4",
  "@mui/material": "^7.3.4",
  "@zxing/library": "^0.21.3",
  "firebase": "^12.4.0",
  "react": "^19.1.1",
  "react-dom": "^19.1.1",
  "react-icons": "^5.5.0",
  "recharts": "^3.2.1",
  "tesseract.js": "^6.0.1",
  "uuid": "^13.0.0",
  "zustand": "^5.0.8"
}
```

### 開発ツール（devDependencies）
```json
{
  "@eslint/js": "^9.36.0",
  "@types/node": "^24.6.0",
  "@types/react": "^19.1.16",
  "@types/react-dom": "^19.1.9",
  "@types/uuid": "^10.0.0",
  "@vitejs/plugin-react": "^5.0.4",
  "eslint": "^9.36.0",
  "eslint-plugin-react-hooks": "^5.2.0",
  "eslint-plugin-react-refresh": "^0.4.22",
  "gh-pages": "^6.3.0",
  "globals": "^16.4.0",
  "typescript": "~5.9.3",
  "typescript-eslint": "^8.45.0",
  "vite": "^7.1.7"
}
```

### Cloud Functions（functions/package.json）
```json
{
  "engines": {
    "node": "18"
  },
  "dependencies": {
    "firebase-admin": "^12.0.0",
    "firebase-functions": "^5.0.0",
    "nodemailer": "^6.9.8"
  },
  "devDependencies": {
    "@types/nodemailer": "^6.4.14",
    "typescript": "^5.3.3"
  }
}
```

---

## 🔑 環境変数

### 必要な環境変数（`.env`）
```env
# Gemini API
VITE_GEMINI_API_KEY=YOUR_KEY_HERE

# 楽天API
VITE_RAKUTEN_APP_ID=YOUR_KEY_HERE

# JAN Code Lookup API
VITE_JANCODE_APP_ID=YOUR_KEY_HERE

# Firebase
VITE_FIREBASE_API_KEY=YOUR_KEY_HERE
VITE_FIREBASE_AUTH_DOMAIN=YOUR_DOMAIN_HERE
VITE_FIREBASE_PROJECT_ID=YOUR_PROJECT_ID_HERE
VITE_FIREBASE_STORAGE_BUCKET=YOUR_BUCKET_HERE
VITE_FIREBASE_MESSAGING_SENDER_ID=YOUR_SENDER_ID_HERE
VITE_FIREBASE_APP_ID=YOUR_APP_ID_HERE

# EmailJS (未使用)
VITE_EMAILJS_SERVICE_ID=YOUR_SERVICE_ID_HERE
VITE_EMAILJS_TEMPLATE_ID=YOUR_TEMPLATE_ID_HERE
VITE_EMAILJS_PUBLIC_KEY=YOUR_PUBLIC_KEY_HERE
```

### Firebase Functions環境変数
```bash
firebase functions:config:set \
  gmail.email="YOUR_EMAIL@gmail.com" \
  gmail.password="YOUR_APP_PASSWORD"
```

---

## 📚 参考資料

### 公式ドキュメント
- [React](https://react.dev/)
- [TypeScript](https://www.typescriptlang.org/)
- [Vite](https://vitejs.dev/)
- [Zustand](https://zustand.docs.pmnd.rs/)
- [Recharts](https://recharts.org/)
- [Firebase](https://firebase.google.com/docs)
- [Google Gemini API](https://ai.google.dev/)
- [React Icons](https://react-icons.github.io/react-icons/)
- [Material UI](https://mui.com/)

### リポジトリ
- **GitHub**: https://github.com/Haradakouta/life-pwa-react
- **GitHub Pages**: https://haradakouta.github.io/life-pwa-react/

---

## 🎯 技術選定の理由

### なぜReact 19？
- 最新の機能とパフォーマンス改善
- コンポーネントベースの再利用性
- 大規模なエコシステム

### なぜZustand？
- Reduxより軽量でシンプル
- ボイラープレート不要
- TypeScriptとの親和性が高い

### なぜVite？
- 開発サーバーの起動が超高速
- HMRが瞬時に反映
- ビルドサイズの最適化

### なぜFirebase？
- 認証・データベースが統合
- リアルタイム同期が簡単
- 無料枠が充実

### なぜGemini API？
- 最新のAI機能
- マルチモーダル（画像+テキスト）
- Free Tierが充実（15リクエスト/分）

---

## 📊 パフォーマンス指標

### バンドルサイズ
- **dist/assets/index-XXX.js**: 約1,593KB
- **gzip圧縮後**: 約450KB
- **今後の目標**: 1,000KB以下

### ページ読み込み時間
- **初回読み込み**: 約2-3秒
- **キャッシュ後**: 約0.5秒

### Lighthouse スコア（目標）
- **Performance**: 90+
- **Accessibility**: 90+
- **Best Practices**: 90+
- **SEO**: 90+

---

## 🔮 今後の技術改善予定

### 優先度: 高
- [ ] バンドルサイズ削減（コード分割、React.lazy）
- [ ] パフォーマンス最適化（メモ化、useMemo/useCallback）
- [ ] Node.js 18 → 20にアップグレード

### 優先度: 中
- [ ] E2Eテスト追加（Playwright）
- [ ] ユニットテスト追加（Vitest）
- [ ] アクセシビリティ向上（ARIA属性）

### 優先度: 低
- [ ] WebAssembly導入検討
- [ ] GraphQL導入検討
- [ ] サーバーサイドレンダリング（SSR）検討

---

**このドキュメントは定期的に更新されます。**

**最終更新: 2025-10-27**
