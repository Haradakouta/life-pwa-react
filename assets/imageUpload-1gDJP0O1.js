import{r as i,u as w,g}from"./firebase-vendor-mxbbJSnD.js";import{s as p}from"./index-B8qdfcdn.js";const u=(r,a,e)=>new Promise((t,o)=>{const d=new FileReader;d.readAsDataURL(r),d.onload=v=>{const l=new Image;l.src=v.target?.result,l.onload=()=>{const c=document.createElement("canvas");let s=l.width,n=l.height;s>n?s>a&&(n=n*a/s,s=a):n>e&&(s=s*e/n,n=e),c.width=s,c.height=n,c.getContext("2d")?.drawImage(l,0,0,s,n),c.toBlob(m=>{m?t(m):o(new Error("画像のリサイズに失敗しました"))},r.type)},l.onerror=()=>o(new Error("画像の読み込みに失敗しました"))},d.onerror=()=>o(new Error("ファイルの読み込みに失敗しました"))}),R=async(r,a)=>{try{const e=await u(a,512,512),t=i(p,`avatars/${r}/${Date.now()}_avatar.jpg`);await w(t,e);const o=await g(t);return console.log("✅ Avatar uploaded:",o),o}catch(e){throw console.error("Avatar upload error:",e),new Error("プロフィール画像のアップロードに失敗しました")}},E=async(r,a)=>{try{const e=await u(a,1200,400),t=i(p,`covers/${r}/${Date.now()}_cover.jpg`);await w(t,e);const o=await g(t);return console.log("✅ Cover uploaded:",o),o}catch(e){throw console.error("Cover upload error:",e),new Error("カバー画像のアップロードに失敗しました")}},I=async(r,a)=>{try{const e=await u(a,1080,1080),t=i(p,`posts/${r}/${Date.now()}_${a.name}`);await w(t,e);const o=await g(t);return console.log("✅ Post image uploaded:",o),o}catch(e){throw console.error("Post image upload error:",e),new Error("投稿画像のアップロードに失敗しました")}},z=r=>r.size>10485760?{valid:!1,error:"画像サイズは10MB以下にしてください"}:["image/jpeg","image/png","image/gif","image/webp"].includes(r.type)?{valid:!0}:{valid:!1,error:"対応している画像形式: JPEG, PNG, GIF, WebP"};export{R as a,I as b,E as u,z as v};
